<app-header />
<div class="container p-2">
    <div class="card shadow-sm p-3">
        <div class="d-flex justify-content-between my-1">
            <span class="fs-3 fw-bolder">
                Blog
            </span>
            <a class="btn text-white">
                <!-- [routerLink]="['/admin/new-blog']"> -->
                Add New
            </a>
        </div>
        <hr class="m-0 my-2" />
        <div class="d-flex">
            <div class="input-group flex-nowrap filter-div me-2">
                <span class="input-group-text" id="addon-wrapping">
                    <i class="bi bi-search"></i>
                </span>
                <input
                    (input)="onSearchInputChange($event)"
                    type="search"
                    class="form-control"
                    placeholder="Search"
                    aria-label="Search"
                    aria-describedby="addon-wrapping" />
            </div>
            <div class="form-floating filter-div me-2">
                <select
                    (change)="onStatusChange($event)"
                    class="form-select"
                    id="floatingSelect"
                    aria-label="status">
                    <option value="5" selected>All</option>
                    <option value="0">Pending</option>
                    <option value="1">Approved</option>
                    <option value="2">Rejected</option>
                </select>
                <label for="floatingSelect">Status</label>
            </div>
            <div class="form-floating filter-div">
                <select
                    (change)="onUserChange($event)"
                    class="form-select"
                    id="floatingSelect"
                    aria-label="User">
                    <option [value]=0 selected>All</option>
                    @for(user of users;track user.id){
                    <option [value]="user.id">{{user.firstName}}
                        {{user.lastName}}</option>
                    }
                </select>
                <label for="floatingSelect">User</label>
            </div>
        </div>
    </div>
    <div class="mt-3 card shadow-sm p-3">
        @defer (when response!= null) {
        <table
            class="table table-responsive text-center table-bordered rounded-2">
            <thead>
                <tr class="align-middle">
                    <th class="col-4">
                        Title
                    </th>
                    <th class="col-1">
                        Created By
                    </th>
                    <th class="col-1">
                        Updated By
                    </th>
                    <th class="col-1">
                        Status
                    </th>
                    <th class="col-1">
                        Approved/ Rejected
                    </th>
                    <th class="col-2">
                        Action
                    </th>
                </tr>
            </thead>
            <tbody>
                @for(blog of response.dtoList; track blog.id){
                <tr class="align-middle">
                    <td>
                        {{blog.title}}
                    </td>
                    <td>
                        {{blog.createdBy}}
                    </td>
                    <td>
                        {{blog.updatedBy}}
                    </td>
                    <td>
                        {{blog.status | enumIntToValue}}
                    </td>
                    <td class="fs-4">
                        @if(blog.status == 0){
                        <button class="bg-transparent border-0"
                            (click)="onBlogStatusChange(blog,true)">
                            <i class="bi bi-check2-circle"></i>
                        </button>
                        |
                        <button class="bg-transparent border-0"
                            (click)="onBlogStatusChange(blog,false)">
                            <i class="bi bi-ban fs-5"></i>
                        </button>
                        }
                    </td>
                    <td class="fs-5">
                        <button class="bg-transparent border-0">
                            Edit
                        </button>
                        |
                        <a class="bg-transparent border-0"
                            [routerLink]="['/author/view-blog', blog.id]">
                            View
                        </a>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        <nav>
            <ul class="pagination justify-content-end">
                <li class="page-item"
                    [ngClass]="{'disabled': !response.isPrevious}">
                    <button class="page-link" tabindex="-1"
                        (click)="onPreviousPageButtonClick()">Previous</button>
                </li>
                <li class="page-item active">
                    <button class="page-link"
                        [disabled]="true">{{response.pageNo}} <span
                            class="sr-only">(current)</span></button>
                </li>
                <li class="page-item"
                    [ngClass]="{'disabled': !response.isNext}">
                    <button class="page-link"
                        (click)="onNextPageButtonClick()">Next</button>
                </li>
            </ul>
        </nav>
        }
    </div>
</div>
